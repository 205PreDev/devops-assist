# 문서 작성 완성 계획: devops-assist

작성일: 2026-02-27
대상 브랜치: claude/continue-document-writing-rCgWx

---

## 배경

devops-assist는 블록 기반 리치 텍스트 에디터 + AI 보조 기능을 갖춘
개인 지식 관리 웹 서비스다.
초기 문서 세트(v0.1 초안)가 커밋되어 있으나 아래 항목들이 미완성 상태다:

- 설계서.md: 에러 처리 설계·보안 설계 없음, 미결 사항 미해결
- 아키텍처.md: 시퀀스 다이어그램 없음
- API 명세서: 파일 자체가 없음 (아키텍처.md에 엔드포인트 목록만 존재)

코드 작성 없이 문서·설계 작업만 진행한다.

---

## 작업 순서 (의존성 고려)

### 1단계: docs/설계서.md 업데이트 (v0.1 → v0.2)

파일: /home/user/devops-assist/docs/설계서.md

추가할 섹션 3개:

[섹션 8 — 에러 처리 설계]
- 공통 에러 응답 JSON 형식 (timestamp, status, error, message, path)
- HTTP 상태 코드 정책 표 (200/201/204/400/401/403/404/409/500/503)
- 도메인별 에러 코드 표 (AUTH_, DOC_, FOLD_, TAG_, AI_ 접두사)
- Spring Boot 구현 방향 (@RestControllerAdvice, 커스텀 예외 계층)
- 프론트엔드 에러 처리 (401 자동 토큰 재발급, SSE 에러 처리 등)

[섹션 9 — 보안 설계]
- CORS 설정 (dev/prod 분리, allowCredentials)
- 입력 유효성 검증 규칙 표 (Bean Validation 기반)
- XSS 방지 (Tiptap JSON 저장 방식으로 raw HTML 주입 차단)
- JWT 보안 상세 (Access Token 메모리 저장, Refresh Token Rotation, HttpOnly 쿠키)
- API 접근 제어 (공개/인증 필요/소유권 검증 3단계)

[섹션 10 — 미결 사항 → Phase A 결정 사항 전환]
  항목          Phase A 결정
  DB 호스팅     로컬 MySQL
  배포 환경     포트포워딩
  이미지 첨부   Phase A 미포함
  다국어        한국어 전용


### 2단계: docs/API_명세서.md 신규 생성

파일: /home/user/devops-assist/docs/API_명세서.md

6개 섹션으로 구성:

[섹션 1 — 공통 규칙]
- Base URL, Authorization 헤더 형식
- 공통 에러 응답 예시, 날짜 형식, Content-Type 규칙

[섹션 2 — 인증 API] (4개 엔드포인트)
- POST /api/auth/signup — 요청/응답 JSON, 유효성 규칙, 에러 표
- POST /api/auth/login — Refresh Token HttpOnly 쿠키 포함 명시
- POST /api/auth/refresh — Rotation 방식 명시
- POST /api/auth/logout — 204 No Content

[섹션 3 — 문서 API] (6개 엔드포인트)
- GET /api/documents — 쿼리 파라미터(folderId, tagId, favorited) + 목록 응답
- POST /api/documents — 생성 요청/응답
- GET /api/documents/{id} — Tiptap JSON content 구조 포함 상세 응답
- PUT /api/documents/{id} — 자동저장 겸용, tags 배열 자동 생성/해제
- DELETE /api/documents/{id}
- PATCH /api/documents/{id}/move

[섹션 4 — 폴더 API] (4개 엔드포인트)
- GET /api/folders — 재귀 트리 구조 응답
- POST /api/folders — FOLD_MAX_DEPTH 에러 포함
- PUT /api/folders/{id}
- DELETE /api/folders/{id} — 하위 문서는 루트로 이동, FOLD_HAS_CHILDREN 에러

[섹션 5 — 태그 API] (3개 엔드포인트)
- GET /api/tags — documentCount 포함
- PUT /api/tags/{id}
- DELETE /api/tags/{id}

[섹션 6 — AI API] (5개 엔드포인트)
- POST /api/ai/related/{docId} — JSON 응답, reason + score + commonTags
- GET /api/ai/summarize/{docId} — SSE 스트리밍, data: {"chunk": "..."} + data: [DONE]
- GET /api/ai/suggest/{docId} — SSE 스트리밍 동일 형식
- POST /api/ai/search — Phase A 후반, 자연어 검색 + sources
- POST /api/ai/tags/{docId} — Phase A 후반, 태그 제안


### 3단계: docs/아키텍처.md 업데이트 (v0.1 → v0.2)

파일: /home/user/devops-assist/docs/아키텍처.md

기존 섹션 6 이후에 섹션 7 — 시퀀스 다이어그램 추가 (Mermaid 문법):

- 7.1 인증 흐름 (4개): 회원가입, 로그인, Access Token 재발급, 로그아웃
- 7.2 문서 CRUD 흐름 (3개): 문서 생성, 자동 저장(debounce + retry), 문서 삭제
- 7.3 AI 관련 문서 추천 흐름 (1개): 워크스페이스 전체 문서 → Gemini 분석 → 상위 5개 반환
- 7.4 AI 스트리밍 흐름 (1개): SSE 청크 수신 → 클라이언트 실시간 출력 → [DONE]

---

## 수정 대상 파일 요약

  파일                    작업                                       변경 규모
  docs/설계서.md          섹션 8·9·10 추가, 버전 0.2                 +약 120줄
  docs/API_명세서.md      신규 생성                                   +약 280줄
  docs/아키텍처.md        섹션 7 시퀀스 다이어그램 추가, 버전 0.2     +약 170줄

---

## 작업 후 커밋 및 푸시

브랜치: claude/continue-document-writing-rCgWx
커밋 메시지: "문서 작성 완성: 설계서 v0.2, API 명세서 신규, 아키텍처 시퀀스 다이어그램 추가"
푸시 명령: git push -u origin claude/continue-document-writing-rCgWx
