# devops-assist 설계서

> 버전: 0.1 | 작성일: 2026-02-27 | 상태: 초안

---

## 1. 프로젝트 개요

**devops-assist**는 계정 기반 개인 지식 관리 웹 서비스다.
사용자는 블록 기반 리치 텍스트 에디터로 문서를 작성하고,
AI가 관련 문서를 추천하거나 요약·보완 제안을 제공한다.

### 목표

- **개인 생산성**: 내가 먼저 써보며 검증
- **포트폴리오**: AI 기반 지식 관리 서비스 구현 경험
- **단계 확장**: A(문서) → B(프로젝트 연결) → C(통합)

---

## 2. 핵심 사용 시나리오

### 시나리오 1: 문서 작성 + 자동 저장
```
사용자 로그인
→ 새 문서 생성
→ 블록 에디터에서 내용 입력 (slash command로 블록 추가)
→ 태그 입력
→ 3초 후 자동 저장
```

### 시나리오 2: AI 관련 문서 추천
```
문서 A 열람 중
→ 사이드바에 "관련 문서" 패널 자동 로드
→ Gemini가 문서 A 내용 분석 → 유사 문서 B, C, D 추천
→ 추천 문서 클릭 → 해당 문서로 이동
```

### 시나리오 3: AI 요약 및 보완 제안
```
문서 작성 완료
→ "요약" 버튼 클릭 → SSE 스트리밍으로 요약 출력
→ "보완 제안" 버튼 클릭 → Gemini가 부족한 부분 제안
→ 제안 내용을 문서에 삽입 버튼으로 추가
```

### 시나리오 4: 문서 구조 관리
```
왼쪽 사이드바: 폴더 트리 표시
→ 폴더 생성/이름 변경/삭제
→ 문서 드래그로 폴더 간 이동
→ 태그 필터 클릭 → 해당 태그 문서만 표시
```

---

## 3. UI 레이아웃

```
┌──────────────────────────────────────────────────────────────┐
│  devops-assist             [검색창]         [사용자명 ▼]      │  ← 헤더
├─────────────────┬────────────────────────┬───────────────────┤
│  📁 폴더 트리   │                        │  AI 패널          │
│                 │   문서 에디터           │                   │
│  - 폴더 A       │                        │  [관련 문서]       │
│    - 문서 1     │   제목 ___________     │  - 문서 B         │
│    - 문서 2     │                        │  - 문서 C         │
│  - 폴더 B       │   / 블록 에디터        │  - 문서 D         │
│    - 문서 3     │   내용 입력 영역       │                   │
│                 │                        │  [요약] [제안]    │
│  🏷 태그        │                        │                   │
│  #spring        │   태그: [spring] [jwt] │  AI 응답 스트리밍 │
│  #java          │                        │  출력 영역        │
│  #정리          │   저장됨 ✓  수정일시  │                   │
└─────────────────┴────────────────────────┴───────────────────┘
```

---

## 4. 인증 흐름

```
회원가입: email + password + username
  → bcrypt 해싱 저장
  → 가입 완료

로그인: email + password
  → 검증
  → Access Token (15분) + Refresh Token (7일) 발급
  → Access Token: Authorization 헤더
  → Refresh Token: HttpOnly 쿠키

요청마다: Authorization: Bearer {accessToken}
  → JwtAuthFilter에서 검증
  → 만료 시 /api/auth/refresh 호출 → 재발급

로그아웃: Refresh Token DB에서 삭제
```

---

## 5. AI 서비스 설계

### GeminiService (dev-agent 패턴 재사용)

```java
// 스트리밍 (SSE)
Flux<String> streamSummary(String documentContent);
Flux<String> streamSuggestion(String documentContent);

// 일반 응답 (JSON)
List<RelatedDocResult> findRelatedDocs(String content, List<Document> workspace);
List<String> suggestTags(String content);
```

### 관련 문서 추천 로직

```
현재 문서 내용 → Gemini에 요약 키워드 추출 요청
→ 워크스페이스 전체 문서 제목 + 태그 목록과 비교
→ 유사도 계산 (키워드 겹침 + 태그 교집합)
→ 상위 5개 반환

Phase A 후반에서 벡터 임베딩으로 업그레이드 고려
```

---

## 6. 자동 저장 설계

```
에디터 변경 감지 (Tiptap onChange)
→ 3초 debounce
→ PUT /api/documents/{id} 호출
→ 응답 성공 시 "저장됨 ✓" 표시
→ 실패 시 "저장 실패 — 재시도 중..." 표시 + retry
```

---

## 7. 개발 우선순위 (Phase A)

### Sprint 1 — 기반
- [ ] Spring Boot 프로젝트 세팅 (포트 8080, MySQL 연결)
- [ ] JWT 인증 (회원가입, 로그인, 재발급, 로그아웃)
- [ ] Document CRUD API
- [ ] Folder CRUD API
- [ ] Tag API

### Sprint 2 — 에디터
- [ ] React + Vite 프론트 세팅
- [ ] Tiptap 블록 에디터 구현
- [ ] 폴더 트리 사이드바
- [ ] 자동 저장 연동

### Sprint 3 — AI
- [ ] GeminiService 통합
- [ ] 관련 문서 추천
- [ ] 요약 / 보완 제안 (SSE 스트리밍)

### Sprint 4 — 마무리
- [ ] 태그 자동 제안 (AI)
- [ ] 자연어 검색
- [ ] 배포 (단일 JAR)
- [ ] 본인 테스트

---

## 8. 미결 사항

| 항목 | 내용 | 결정 필요 |
|------|------|-----------|
| DB 호스팅 | 로컬 MySQL vs 클라우드 | 배포 시점에 결정 |
| 배포 환경 | 포트포워딩 vs AWS/GCP | 테스터 제공 시점에 결정 |
| 이미지 첨부 | Phase A에 포함? | 미결 |
| 다국어 | 한국어 전용 or 영어 병행? | 미결 |
